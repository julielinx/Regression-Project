rm(new_RentRate)
new_RentRate <- data.frame(Age=9, OperExp=13, SqFt=40, Taxes=540, W2MiDT="1")
predict(df_model, newdata=new_RentRate, interval="predict")
new_RentRate <- data.frame(Age=9, OperExp=13, SqFt=40, Taxes=540, W2MiDT='Yes')
predict(df_model, newdata=new_RentRate, interval="predict")
new_RentRate <- data.frame(Age=9, OperExp=13, SqFt=40, Taxes=540, W2MiDT='No')
predict(df_model, newdata=new_RentRate, interval="predict")
sur_n <- 1259
sur <- c(rep(1, 655), rep(0, 594))
EZanswer <- prop.test(x=sum(sur), n=sur_n, p=0.5, correct=FALSE)
EZanswer
library(MASS)
model.full.int <- lm(Sales ~ .*., data=Carseats)
summary(model.full.int)
predict(model.full.int, newdata=new_RentRate, interval="predict")
model.full.int <- lm(RentRate ~ .*., data=comm_prop)
summary(model.full.int)
predict(model.full.int, newdata=new_RentRate, interval="predict")
names(comm_prop)
unique(comm_prop$VacRate)
new_RentRate <- data.frame(Age=9, OperExp=13, VacRate=0, SqFt=40, Taxes=540, W2MiDT='No')
predict(df_model, newdata=new_RentRate, interval="predict")
predict(model.full.int, newdata=new_RentRate, interval="predict")
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(corrplot)
comm_prop <- tbl_df(read_csv("comm_prop.csv"))
comm_prop$W2MiDT <- factor(comm_prop$W2MiDT, labels = c("No", 'Yes'))
predict(model.full.int, newdata=new_RentRate, interval="predict")
updated_Rent <- data.frame(Age=9, OperExp=13, VacRate=0, SqFt=40, Taxes=540, W2MiDT=0)
predict(model.full.int, newdata=updated_Rent, interval="predict")
glimpse(comm_prop)
glimpse(model.full.int)
model.full.int <- lm(RentRate ~ ., data=comm_prop)
predict(model.full.int, newdata=new_RentRate, interval="predict")
model.full.int <- lm(RentRate ~ .*., data=comm_prop)
predict(model.full.int, newdata=new_RentRate, interval="predict")
names(comm_prop)
model.full.int <- lm(RentRate ~ (Age + OperExp + VacRate + SqFt + Taxes + W2MiDT)^2, data=comm_prop)
summary(model.full.int)
predict(model.full.int, newdata=new_RentRate, interval="predict")
cor(comm_prop)
summary(model.full.int)
model.full.int <- lm(RentRate ~ (Age + OperExp + VacRate + SqFt + W2MiDT)^2, data=comm_prop)
summary(model.full.int)
model_all <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + VacRate:SqFt + VacRate:W2MiDT + SqFt:W2MiDT, data=comm_prop)
model_1 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + VacRate:SqFt + SqFt:W2MiDT, data=comm_prop)
summary(model_1)
model_1 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + VacRate:SqFt + SqFt:W2MiDT, data=comm_prop)
summary(model_1)
model_2 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_2)
model_3 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_3)
model_4 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_4)
model_5 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_5)
model_all <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + VacRate:SqFt + VacRate:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_all)
model_6 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_6)
summary(model_5)
summary(model.full.int)
summary(model_1)
summary(model_2)
summary(model_3)
summary(model_4)
summary(model_5)
summary(model_6)
summary(model_all)
summary(model_1)
summary(model_2)
summary(model_3)
model_4 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:W2MiDT + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_4)
model_5 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_5)
model_6 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_6)
model_7 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_7)
predict(model_7, newdata=new_RentRate, interval="predict")
predict(df_model, newdata=new_RentRate, interval="predict")
relate_pred <- predict(model.full.int, newdata=new_RentRate, interval="predict")
Ori_pred <- predict(model.full.int, newdata=new_RentRate, interval="predict")
ori_pred <- predict(model.full.int, newdata=new_RentRate, interval="predict")
rm(Ori_pred)
ls(ori_pred)
class(ori_pred)
ori_pred$lwr - ori_pred$upr
names(ori_pred)
17.26704 - 13.98471
16.23517 - 12.16037
hist(comm_prop$RentRate, xlab = "Rent Rate", main = paste("Rent Rate (In Thousands)"), col = "indianred")
hist(comm_prop$Age, xlab = "Age", main = paste("Age"), col = "indianred")
hist(comm_prop$OperExp, xlab = "Total Monthly Operating Expenses", main = paste("Total Monthly Operating Expenses (In Thousands)"), col = "indianred")
hist(comm_prop$VacRate, xlab = "Vacancy Rate", main = paste("Vacancy Rate"), col = "indianred")
hist(comm_prop$SqFt, xlab = "Total Square Footage", main = paste("Total Square Footage"), col = "indianred")
hist(comm_prop$Taxes, xlab = "Taxes", main = paste("Total Monthly Tax Expense (In Thousands)"), col = "indianred")
ggplot(comm_prop$W2MiDT) +
stat_boxplot(geom = "errorbar", width = 0.5) +
geom_boxplot() +
coord_flip() + # Makes regions names easier to read
labs(x = "Region", y = "Birth Rate")
is.na(x=comm_prop)
sum(is.na(x=comm_prop))
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(corrplot)
comm_prop <- tbl_df(read_csv("comm_prop.csv"))
dim(comm_prop)
names(comm_prop)
sum(is.na(comm_prop))
head(comm_prop)
summary(comm_prop)
dim(comm_prop)
names(comm_prop)
(NA_values <- sum(is.na(comm_prop)))
head(comm_prop)
summary(comm_prop)
ggplot(comm_prop$W2MiDT) +
stat_histogram() +
labs(x = "Region", y = "Birth Rate")
comm_prop$W2MiDT <- factor(comm_prop$W2MiDT, labels = c("No", 'Yes'))
head(comm_prop)
sum(is.na(comm_prop))
summary(comm_prop)
hist(comm_prop$RentRate, xlab = "Rent Rate", main = paste("Rent Rate (In Thousands)"), col = "indianred")
hist(comm_prop$Age, xlab = "Age", main = paste("Age"), col = "indianred")
hist(comm_prop$OperExp, xlab = "Total Monthly Operating Expenses", main = paste("Total Monthly Operating Expenses (In Thousands)"), col = "indianred")
hist(comm_prop$VacRate, xlab = "Vacancy Rate", main = paste("Vacancy Rate"), col = "indianred")
hist(comm_prop$SqFt, xlab = "Total Square Footage", main = paste("Total Square Footage"), col = "indianred")
hist(comm_prop$Taxes, xlab = "Taxes", main = paste("Total Monthly Tax Expense (In Thousands)"), col = "indianred")
ggplot(comm_prop$W2MiDT) +
stat_histogram() +
labs(x = "Region", y = "Birth Rate")
ggplot(comm_prop, aes(x=W2MiDT)) +
geom_histogram()
ggplot(comm_prop, aes(x=W2MiDT)) +
geom_histogram(stat="count")
ggplot(comm_prop, aes(x=W2MiDT)) +
geom_histogram(stat="count", color="steelgray")
ggplot(comm_prop, aes(x=W2MiDT)) +
geom_histogram(stat="count", color="steelblue")
ggplot(comm_prop, aes(x=W2MiDT), color="steelblue") +
geom_histogram(stat="count")
ggplot(comm_prop, aes(x=W2MiDT)) +
geom_histogram(stat="count")
ggplot(comm_prop, aes(x=W2MiDT))
hist(comm_prop$W2MiDT, xlab = "Building Located Within 2 Miles of Downtown", main = paste("Location"), col = "indianred")
hist(comm_prop$RentRate, xlab = "Rent Rate", main = paste("Rent Rate (In Thousands)"), col = "indianred")
hist(comm_prop$Age, xlab = "Age", main = paste("Age"), col = "indianred")
hist(comm_prop$OperExp, xlab = "Total Monthly Operating Expenses", main = paste("Total Monthly Operating Expenses (In Thousands)"), col = "indianred")
hist(comm_prop$VacRate, xlab = "Vacancy Rate", main = paste("Vacancy Rate"), col = "indianred")
hist(comm_prop$SqFt, xlab = "Total Square Footage", main = paste("Total Square Footage"), col = "indianred")
hist(comm_prop$Taxes, xlab = "Taxes", main = paste("Total Monthly Tax Expense (In Thousands)"), col = "indianred")
ggplot(comm_prop, aes(x=W2MiDT)) +
geom_histogram(stat="count")
pairs(comm_prop[,1:6], pch = 16)
ggplot(comm_prop, aes(x=W2MiDT)) +
geom_histogram(stat="count")
ggplot(comm_prop, aes(x=W2MiDT)) +
geom_histogram(binwidth = 1, stat="count")
ggplot(comm_prop, aes(x=W2MiDT)) +
geom_bar(aes(stat="identity"))
ggplot(comm_prop, aes(x=W2MiDT)) +
geom_bar(aes(stat="count"))
ggplot(comm_prop, aes(x=W2MiDT, y=..count..)) +
geom_bar()
hist(comm_prop$RentRate, xlab = "Rent Rate", main = paste("Rent Rate (In Thousands)"), col = "indianred")
hist(comm_prop$Age, xlab = "Age", main = paste("Age"), col = "indianred")
hist(comm_prop$OperExp, xlab = "Total Monthly Operating Expenses", main = paste("Total Monthly Operating Expenses (In Thousands)"), col = "indianred")
hist(comm_prop$VacRate, xlab = "Vacancy Rate", main = paste("Vacancy Rate"), col = "indianred")
hist(comm_prop$SqFt, xlab = "Total Square Footage", main = paste("Total Square Footage"), col = "indianred")
hist(comm_prop$Taxes, xlab = "Taxes", main = paste("Total Monthly Tax Expense (In Thousands)"), col = "indianred")
ggplot(comm_prop, aes(x=W2MiDT, y=..count..)) +
geom_bar()
pairs(comm_prop[,1:6], pch = 16)
hist(comm_prop$RentRate, xlab = "Rent Rate", main = paste("Rent Rate (In Thousands)"), col = "indianred")
hist(comm_prop$Age, xlab = "Age", main = paste("Age"), col = "indianred")
hist(comm_prop$OperExp, xlab = "Total Monthly Operating Expenses", main = paste("Total Monthly Operating Expenses (In Thousands)"), col = "indianred")
hist(comm_prop$VacRate, xlab = "Vacancy Rate", main = paste("Vacancy Rate"), col = "indianred")
hist(comm_prop$SqFt, xlab = "Total Square Footage", main = paste("Total Square Footage"), col = "indianred")
hist(comm_prop$Taxes, xlab = "Taxes", main = paste("Total Monthly Tax Expense (In Thousands)"), col = "indianred")
ggplot(comm_prop, aes(x=W2MiDT, y=..count..)) +
geom_bar()
pairs(comm_prop[,1:6], pch = 16)
df.full <- lm(RentRate ~ ., data = comm_prop)
summary(df.full)
cor(comm_prop)
pairs(comm_prop[,1:6], pch = 16)
corrplot(cor(comm_prop), method="ellipse")
pairs(comm_prop[,1:6], pch = 16)
numeric_df <- comm_prop[1:6]
cor(numeric_df)
corrplot(cor(numeric_df), method="ellipse")
df.full <- lm(RentRate ~ ., data = comm_prop)
summary(df.full)
dfLessMin <- lm(RentRate ~ Age + OperExp + W2MiDT, data = comm_prop)
summary(dfLessMin)
df_model <- lm(RentRate ~ Age + OperExp + W2MiDT + SqFt, data = comm_prop)
summary(df_model)
full.df <- fortify(df_model)
ggplot(full.df, aes(x=.fitted, y=.resid)) +
geom_point() +
geom_hline(yintercept=0, linetype=2) +
labs(x="Fitted Values", y="Residuals")
qqPlot(df_model$residuals, pch=16)
shapiro.test(df_model$residuals)
pairs(comm_prop[-c(4,6)], pch=16)
ncvTest(df_model)
vif(df_model)
full.df <- fortify(df_model)
ggplot(full.df, aes(x=.fitted, y=.resid)) +
geom_point() +
geom_hline(yintercept=0, linetype=2) +
labs(x="Fitted Values", y="Residuals")
qqPlot(df_model$residuals, pch=16)
shapiro.test(df_model$residuals)
pairs(comm_prop[-c(4,6)], pch=16)
ncvTest(df_model)
vif(df_model)
ggplot(full.df, aes(x=.fitted, y=RentRate)) +
geom_point(size=2) +
geom_smooth(method="lm", color="red", lwd=1.5) +
labs(x="Rent Predicted", y="Rent Actual")
new_RentRate <- data.frame(Age=9, OperExp=13, SqFt=40, Taxes=540, W2MiDT='No')
full.df <- fortify(df_model)
ggplot(full.df, aes(x=.fitted, y=.resid)) +
geom_point() +
geom_hline(yintercept=0, linetype=2) +
labs(x="Fitted Values", y="Residuals")
qqPlot(df_model$residuals, pch=16)
shapiro.test(df_model$residuals)
pairs(comm_prop[-c(4,6)], pch=16)
ncvTest(df_model)
vif(df_model)
ggplot(full.df, aes(x=.fitted, y=RentRate)) +
geom_point(size=2) +
geom_smooth(method="lm", color="red", lwd=1.5) +
labs(x="Rent Predicted", y="Rent Actual")
new_RentRate <- data.frame(Age=9, OperExp=13, SqFt=40, Taxes=540, W2MiDT='No')
predict(df_model, newdata=new_RentRate, interval="predict")
library(MASS)
model.full.int <- lm(RentRate ~ (Age + OperExp + VacRate + SqFt + W2MiDT)^2, data=comm_prop)
# multply all variables by all variables
# becareful about more variables than obsevations
# 6 to 10 observations for each variable
summary(model.full.int)
ori_pred <- predict(model.full.int, newdata=new_RentRate, interval="predict")
model_all <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + VacRate:SqFt + VacRate:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_all)
#remove VacRate:W2MiDT
model_1 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + VacRate:SqFt + SqFt:W2MiDT, data=comm_prop)
summary(model_1)
#remove VacRate:SqFt
model_2 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_2)
#remove OpenExp:SqFt
model_3 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_3)
#remove Age:SqFt
model_4 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:W2MiDT + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_4)
#remove Age:W2MiDT
model_5 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_5)
#remove OpenExp:VacRate
model_6 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_6)
#remove Age:OpenExp
model_7 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_7)
predict(model_7, newdata=new_RentRate, interval="predict")
new_RentRate <- data.frame(Age=9, OperExp=13, VacRate=0, SqFt=40, Taxes=540, W2MiDT='No')
predict(model_7, newdata=new_RentRate, interval="predict")
library(MASS)
model.full.int <- lm(RentRate ~ (Age + OperExp + VacRate + SqFt + W2MiDT)^2, data=comm_prop)
summary(model.full.int)
ori_pred <- predict(model.full.int, newdata=new_RentRate, interval="predict")
model_all <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + VacRate:SqFt + VacRate:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_all)
library(MASS)
model.full.int <- lm(RentRate ~ (Age + OperExp + VacRate + SqFt + W2MiDT)^2, data=comm_prop)
summary(model.full.int)
ori_pred <- predict(model.full.int, newdata=new_RentRate, interval="predict")
model_all <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + VacRate:SqFt + VacRate:W2MiDT + SqFt:W2MiDT, data=comm_prop)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(corrplot)
comm_prop <- tbl_df(read_csv("comm_prop.csv"))
dim(comm_prop)
names(comm_prop)
comm_prop$W2MiDT <- factor(comm_prop$W2MiDT, labels = c("No", 'Yes'))
head(comm_prop)
sum(is.na(comm_prop))
summary(comm_prop)
hist(comm_prop$RentRate, xlab = "Rent Rate", main = paste("Rent Rate (In Thousands)"), col = "indianred")
hist(comm_prop$Age, xlab = "Age", main = paste("Age"), col = "indianred")
hist(comm_prop$OperExp, xlab = "Total Monthly Operating Expenses", main = paste("Total Monthly Operating Expenses (In Thousands)"), col = "indianred")
hist(comm_prop$VacRate, xlab = "Vacancy Rate", main = paste("Vacancy Rate"), col = "indianred")
hist(comm_prop$SqFt, xlab = "Total Square Footage", main = paste("Total Square Footage"), col = "indianred")
hist(comm_prop$Taxes, xlab = "Taxes", main = paste("Total Monthly Tax Expense (In Thousands)"), col = "indianred")
ggplot(comm_prop, aes(x=W2MiDT, y=..count..)) +
geom_bar()
pairs(comm_prop[,1:6], pch = 16)
numeric_df <- comm_prop[1:6]
corrplot(cor(numeric_df), method="ellipse")
cor(numeric_df)
df.full <- lm(RentRate ~ ., data = comm_prop)
summary(df.full)
dfLessMin <- lm(RentRate ~ Age + OperExp + W2MiDT, data = comm_prop)
summary(dfLessMin)
df_model <- lm(RentRate ~ Age + OperExp + W2MiDT + SqFt, data = comm_prop)
summary(df_model)
full.df <- fortify(df_model)
ggplot(full.df, aes(x=.fitted, y=.resid)) +
geom_point() +
geom_hline(yintercept=0, linetype=2) +
labs(x="Fitted Values", y="Residuals")
qqPlot(df_model$residuals, pch=16)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(corrplot)
library(MASS)
comm_prop <- tbl_df(read_csv("comm_prop.csv"))
dim(comm_prop)
names(comm_prop)
comm_prop$W2MiDT <- factor(comm_prop$W2MiDT, labels = c("No", 'Yes'))
head(comm_prop)
sum(is.na(comm_prop))
summary(comm_prop)
hist(comm_prop$RentRate, xlab = "Rent Rate", main = paste("Rent Rate (In Thousands)"), col = "indianred")
hist(comm_prop$Age, xlab = "Age", main = paste("Age"), col = "indianred")
hist(comm_prop$OperExp, xlab = "Total Monthly Operating Expenses", main = paste("Total Monthly Operating Expenses (In Thousands)"), col = "indianred")
hist(comm_prop$VacRate, xlab = "Vacancy Rate", main = paste("Vacancy Rate"), col = "indianred")
hist(comm_prop$SqFt, xlab = "Total Square Footage", main = paste("Total Square Footage"), col = "indianred")
hist(comm_prop$Taxes, xlab = "Taxes", main = paste("Total Monthly Tax Expense (In Thousands)"), col = "indianred")
ggplot(comm_prop, aes(x=W2MiDT, y=..count..)) +
geom_bar()
pairs(comm_prop[,1:6], pch = 16)
numeric_df <- comm_prop[1:6]
corrplot(cor(numeric_df), method="ellipse")
cor(numeric_df)
df.full <- lm(RentRate ~ ., data = comm_prop)
summary(df.full)
dfLessMin <- lm(RentRate ~ Age + OperExp + W2MiDT, data = comm_prop)
summary(dfLessMin)
df_model <- lm(RentRate ~ Age + OperExp + W2MiDT + SqFt, data = comm_prop)
summary(df_model)
full.df <- fortify(df_model)
ggplot(full.df, aes(x=.fitted, y=.resid)) +
geom_point() +
geom_hline(yintercept=0, linetype=2) +
labs(x="Fitted Values", y="Residuals")
shapiro.test(df_model$residuals)
pairs(comm_prop[-c(4,6)], pch=16)
ncvTest(df_model)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(corrplot)
library(MASS)
library(car)
comm_prop <- tbl_df(read_csv("comm_prop.csv"))
dim(comm_prop)
names(comm_prop)
comm_prop$W2MiDT <- factor(comm_prop$W2MiDT, labels = c("No", 'Yes'))
head(comm_prop)
sum(is.na(comm_prop))
summary(comm_prop)
hist(comm_prop$RentRate, xlab = "Rent Rate", main = paste("Rent Rate (In Thousands)"), col = "indianred")
hist(comm_prop$Age, xlab = "Age", main = paste("Age"), col = "indianred")
hist(comm_prop$OperExp, xlab = "Total Monthly Operating Expenses", main = paste("Total Monthly Operating Expenses (In Thousands)"), col = "indianred")
hist(comm_prop$VacRate, xlab = "Vacancy Rate", main = paste("Vacancy Rate"), col = "indianred")
hist(comm_prop$SqFt, xlab = "Total Square Footage", main = paste("Total Square Footage"), col = "indianred")
hist(comm_prop$Taxes, xlab = "Taxes", main = paste("Total Monthly Tax Expense (In Thousands)"), col = "indianred")
ggplot(comm_prop, aes(x=W2MiDT, y=..count..)) +
geom_bar()
pairs(comm_prop[,1:6], pch = 16)
numeric_df <- comm_prop[1:6]
corrplot(cor(numeric_df), method="ellipse")
cor(numeric_df)
df.full <- lm(RentRate ~ ., data = comm_prop)
summary(df.full)
dfLessMin <- lm(RentRate ~ Age + OperExp + W2MiDT, data = comm_prop)
summary(dfLessMin)
df_model <- lm(RentRate ~ Age + OperExp + W2MiDT + SqFt, data = comm_prop)
summary(df_model)
full.df <- fortify(df_model)
ggplot(full.df, aes(x=.fitted, y=.resid)) +
geom_point() +
geom_hline(yintercept=0, linetype=2) +
labs(x="Fitted Values", y="Residuals")
shapiro.test(df_model$residuals)
pairs(comm_prop[-c(4,6)], pch=16)
ncvTest(df_model)
vif(df_model)
ggplot(full.df, aes(x=.fitted, y=RentRate)) +
geom_point(size=2) +
geom_smooth(method="lm", color="red", lwd=1.5) +
labs(x="Rent Predicted", y="Rent Actual")
new_RentRate <- data.frame(Age=9, OperExp=13, SqFt=40, Taxes=540, W2MiDT='No')
predict(df_model, newdata=new_RentRate, interval="predict")
library(MASS)
model.full.int <- lm(RentRate ~ (Age + OperExp + VacRate + SqFt + W2MiDT)^2, data=comm_prop)
summary(model.full.int)
ori_pred <- predict(model.full.int, newdata=new_RentRate, interval="predict")
new_RentRate <- data.frame(Age=9, OperExp=13, VacRate=0, SqFt=40, Taxes=540, W2MiDT='No')
library(MASS)
model.full.int <- lm(RentRate ~ (Age + OperExp + VacRate + SqFt + W2MiDT)^2, data=comm_prop)
summary(model.full.int)
ori_pred <- predict(model.full.int, newdata=new_RentRate, interval="predict")
model_all <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + VacRate:SqFt + VacRate:W2MiDT + SqFt:W2MiDT, data=comm_prop)
model_1 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + VacRate:SqFt + SqFt:W2MiDT, data=comm_prop)
summary(model_1)
#remove VacRate:SqFt
model_2 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_2)
#remove OpenExp:SqFt
model_3 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_3)
#remove Age:SqFt
model_4 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:W2MiDT + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_4)
#remove Age:W2MiDT
model_5 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_5)
#remove OpenExp:VacRate
model_6 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_6)
#remove Age:OpenExp
model_7 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_7)
predict(model_7, newdata=new_RentRate, interval="predict")
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(corrplot)
library(MASS)
library(car)
comm_prop <- tbl_df(read_csv("comm_prop.csv"))
dim(comm_prop)
names(comm_prop)
comm_prop$W2MiDT <- factor(comm_prop$W2MiDT, labels = c("No", 'Yes'))
head(comm_prop)
sum(is.na(comm_prop))
summary(comm_prop)
hist(comm_prop$RentRate, xlab = "Rent Rate", main = paste("Rent Rate (In Thousands)"), col = "indianred")
hist(comm_prop$Age, xlab = "Age", main = paste("Age"), col = "indianred")
hist(comm_prop$OperExp, xlab = "Total Monthly Operating Expenses", main = paste("Total Monthly Operating Expenses (In Thousands)"), col = "indianred")
hist(comm_prop$VacRate, xlab = "Vacancy Rate", main = paste("Vacancy Rate"), col = "indianred")
hist(comm_prop$SqFt, xlab = "Total Square Footage", main = paste("Total Square Footage"), col = "indianred")
hist(comm_prop$Taxes, xlab = "Taxes", main = paste("Total Monthly Tax Expense (In Thousands)"), col = "indianred")
ggplot(comm_prop, aes(x=W2MiDT, y=..count..)) +
geom_bar()
pairs(comm_prop[,1:6], pch = 16)
numeric_df <- comm_prop[1:6]
corrplot(cor(numeric_df), method="ellipse")
cor(numeric_df)
df.full <- lm(RentRate ~ ., data = comm_prop)
summary(df.full)
dfLessMin <- lm(RentRate ~ Age + OperExp + W2MiDT, data = comm_prop)
summary(dfLessMin)
df_model <- lm(RentRate ~ Age + OperExp + W2MiDT + SqFt, data = comm_prop)
summary(df_model)
full.df <- fortify(df_model)
ggplot(full.df, aes(x=.fitted, y=.resid)) +
geom_point() +
geom_hline(yintercept=0, linetype=2) +
labs(x="Fitted Values", y="Residuals")
shapiro.test(df_model$residuals)
pairs(comm_prop[-c(4,6)], pch=16)
ncvTest(df_model)
vif(df_model)
ggplot(full.df, aes(x=.fitted, y=RentRate)) +
geom_point(size=2) +
geom_smooth(method="lm", color="red", lwd=1.5) +
labs(x="Rent Predicted", y="Rent Actual")
new_RentRate <- data.frame(Age=9, OperExp=13, VacRate=0, SqFt=40, Taxes=540, W2MiDT='No')
predict(df_model, newdata=new_RentRate, interval="predict")
library(MASS)
model.full.int <- lm(RentRate ~ (Age + OperExp + VacRate + SqFt + W2MiDT)^2, data=comm_prop)
summary(model.full.int)
ori_pred <- predict(model.full.int, newdata=new_RentRate, interval="predict")
model_all <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + VacRate:SqFt + VacRate:W2MiDT + SqFt:W2MiDT, data=comm_prop)
model_1 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + VacRate:SqFt + SqFt:W2MiDT, data=comm_prop)
summary(model_1)
#remove VacRate:SqFt
model_2 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:SqFt + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_2)
#remove OpenExp:SqFt
model_3 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:SqFt + Age:W2MiDT + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_3)
#remove Age:SqFt
model_4 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + Age:W2MiDT + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_4)
#remove Age:W2MiDT
model_5 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + OperExp:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_5)
#remove OpenExp:VacRate
model_6 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:OperExp + Age:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_6)
#remove Age:OpenExp
model_7 <- lm(RentRate ~ Age + OperExp + VacRate + SqFt + W2MiDT + Age:VacRate + OperExp:W2MiDT + SqFt:W2MiDT, data=comm_prop)
summary(model_7)
predict(model_7, newdata=new_RentRate, interval="predict")
